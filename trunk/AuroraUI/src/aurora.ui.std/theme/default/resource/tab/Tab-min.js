$A.Tab=Ext.extend($A.Component,{constructor:function(a){this.selectIndex=1;this.loaded={};$A.Tab.superclass.constructor.call(this,a)},initComponent:function(a){$A.Tab.superclass.initComponent.call(this,a);this.head=this.wrap.child("td[atype=tab.strips]");this.body=this.wrap.child("div[atype=tab.bodys]");this.selectTab(a.selected||0)},processListener:function(a){$A.Tab.superclass.processListener.call(this,a);this.head[a]("click",this.onClick,this)},initEvents:function(){$A.Tab.superclass.initEvents.call(this);this.addEvents("select")},selectTab:function(d){if(d<0){d=0}var e=Ext.DomQuery.select("div.strip",this.head.dom);var c=Ext.DomQuery.select("div.tab",this.body.dom);var a=e[d];var b=c[d];if(a){if(this.activeTab){this.activeTab.replaceClass("active","unactive")}this.activeTab=Ext.get(a);Ext.fly(a).replaceClass("unactive","active")}if(b){if(this.activeBody){this.activeBody.setLeft("-10000px");this.activeBody.setTop("-10000px")}this.activeBody=Ext.get(b);Ext.fly(b).setLeft("0px");Ext.fly(b).setTop("0px")}if(this.items[d].ref&&this.loaded["tab_"+d]!=true){this.load(this.items[d].ref,b,d);this.loaded["tab_"+d]=true}else{this.fireEvent("select",this,d)}},onClick:function(g){var c=Ext.fly(g.target.parentNode);if(c.hasClass("strip")&&!c.hasClass("active")){var f=Ext.DomQuery.select("div.strip",this.head.dom);for(var b=0,a=f.length;b<a;b++){var d=f[b];if(d==g.target.parentNode){this.selectTab(b);break}}}},showLoading:function(a){Ext.fly(a).update(_lang["tab.loading"]);Ext.fly(a).setStyle("text-align","center");Ext.fly(a).setStyle("line-height",5)},clearLoading:function(a){Ext.fly(a).update("");Ext.fly(a).setStyle("text-align","");Ext.fly(a).setStyle("line-height","")},load:function(b,d,a){if(b.indexOf("?")!=-1){b=b+"&_vw="+this.width+"&_vh="+(this.height-Ext.fly(this.head).getHeight())}else{b=b+"?_vw="+this.width+"&_vh="+(this.height-Ext.fly(this.head).getHeight())}this.showLoading(d);var c=this;Ext.Ajax.request({url:b,success:function(e,f){c.clearLoading(d);var g=e.responseText;Ext.fly(d).update(g,true,function(){c.fireEvent("select",c,a)})}})},setWidth:function(b){b=Math.max(b,2);$A.Tab.superclass.setWidth.call(this,b);if(this.width==b){return}var e=(b-2)+"px";Ext.fly(this.body.dom).setStyle("width",e);var c=Ext.DomQuery.select("div.tab",this.body.dom);for(var d=0;d<c.length;d++){var a=c[d];Ext.fly(a).setStyle("width",e)}},setHeight:function(d){d=Math.max(d,25);$A.Tab.superclass.setHeight.call(this,d);if(this.height==d){return}var e=(d-25)+"px";Ext.fly(this.body.dom).setStyle("height",e);var b=Ext.DomQuery.select("div.tab",this.body.dom);for(var c=0;c<b.length;c++){var a=b[c];Ext.fly(a).setStyle("height",e)}}});