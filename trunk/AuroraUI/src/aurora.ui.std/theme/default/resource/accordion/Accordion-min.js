(function(a){var g="100%",d="selected",e="item-accordion-btn",f="strip-over",c="select",b="beforeselect";a.Accordion=Ext.extend(a.Component,{constructor:function(h){a.Accordion.superclass.constructor.call(this,h)},initComponent:function(h){a.Accordion.superclass.initComponent.call(this,h);var j=this,i=j.wrap;j.selectedItems=[];j.frequency=j.frequency||20;j.actionTimes=j.actionTimes||2;j.currentTime=1;j.accordions=i.select("div.item-accordion");j.strips=i.select("div.accordion-strip");j.bodys=i.select("div.item-accordion-body");j.stripheight=j.stripheight||25;j.accordions.each(function(k,m,n,l){Ext.isIE6&&k.setWidth(g);if(k.hasClass(d)){j.selectAccordionIndex(n)}});Ext.isIE6&&j.bodys.setWidth(g)},processListener:function(h){var i=this;a.Accordion.superclass.processListener.call(i,h);i.wrap[h]("click",i.onClick,i)},initEvents:function(){a.Accordion.superclass.initEvents.call(this);this.addEvents(b,c)},selectAccordionIndex:function(j){var l=this,i=Ext.get(l.accordions.elements[j]);if(l.fireEvent(b,l,j)!=false){if(!i){return}if(l.selectedItems.indexOf(i)!=-1){l.close(i,j)}else{l.singlemode&&Ext.each(l.selectedItems,function(n){l.close(n,l.accordions.elements.indexOf(n.dom))},l);var h=l.bodys.item(j),m=!!h.dom.style.height,k=h.select("*");if(k.elements.length==0&&h.dom.innerHTML){m=true}k.each(function(n){if(n.getHeight()){m=true}});l.selectedItems.push(i.addClass(d).setHeight(l.stripheight+(m?h.show().getHeight():0),{duration:0.2,callback:function(){m&&i.setStyle({height:""});l.load(j)}}))}}},close:function(h,i){var j=this;h.removeClass(d).setHeight(j.stripheight,{duration:0.2,callback:function(){j.bodys.item(i).hide()}});j.selectedItems.remove(h)},onClick:function(i,h){h=(h=Ext.fly(h)).hasClass("accordion-strip")?h:h.parent(".accordion-strip");if(h){this.strips.each(function(l,j,k){if(h.dom==l.dom){this.selectAccordionIndex(k);return false}},this)}},onMouseOver:function(i,h){(h=Ext.fly(h)).hasClass(e)&&h.parent().addClass(f);a.Accordion.superclass.onMouseOver.call(this,i,h)},onMouseOut:function(i,h){(h=Ext.fly(h)).hasClass(e)&&h.parent().removeClass(f);a.Accordion.superclass.onMouseOut.call(this,i,h)},showLoading:function(h){h.update(_lang["accordion.loading"]).setStyle({"text-align":"center","line-height":5})},clearLoading:function(h){h.update("").setStyle({"text-align":"","line-height":""})},load:function(i){var j=this,h=j.items[i].ref,k=Ext.get(j.bodys.elements[i]);if(!h||k.isLoaded){j.fireEvent(c,j,i);return}k.isLoaded=true;k.cmps={};j.showLoading(k);Ext.Ajax.request({url:Ext.urlAppend(h,"_vw="+j.width+"&_vh="+(j.height-j.strips.item(0).getHeight())),success:function(l,m){j.clearLoading(k);k.update(l.responseText,true,function(){j.fireEvent(c,j,i)},k)}})},setHeight:function(m){if(this.height==m){return}var o=this,k=o.bodys,j=k.elements.length,n=o.stripheight,m=Math.max(m,n*j),i=o.singlemode;o.height=m;k.setHeight((m-n*j)/(i?1:j));Ext.each(o.selectedItems,function(h){h.setHeight(i?(m-n*(j-1)):(m/j))})},destroy:function(){Ext.each(this.bodys,function(h){Ext.iterate(Ext.get(h).cmps,function(i,j){try{j.destroy&&j.destroy()}catch(k){alert("销毁Accordion出错: "+k)}})});a.Accordion.superclass.destroy.call(this)}})})($A);