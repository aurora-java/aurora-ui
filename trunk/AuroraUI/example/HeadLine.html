<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Panel</title>
 <link type="text/css" rel="stylesheet" href="../src/com/aurora/ui/theme/default/resource/core/Aurora.css" />
 <link type="text/css" rel="stylesheet" href="../src/com/aurora/ui/theme/default/resource/textfield/TextField.css" /> 
 <link type="text/css" rel="stylesheet" href="../src/com/aurora/ui/theme/default/resource/checkbox/CheckBox.css" />
<link type="text/css" rel="stylesheet" href="../src/com/aurora/ui/theme/default/resource/combobox/ComboBox.css" />
<link type="text/css" rel="stylesheet" href="../src/com/aurora/ui/theme/default/resource/datefield/DateField.css" />
 <script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/core/ext-core.js"></script>
 <script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/core/Aurora.js"></script>
 <script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/core/Component.js"></script>
 <script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/core/Field.js"></script>
 <script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/textfield/TextField.js"></script>
 <script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/core/DataSet.js"></script>
<script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/core/TriggerField.js"></script> 
<script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/combobox/ComboBox.js"></script>
<script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/datefield/DateField.js"></script>
<script language="javascript" type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/datefield/DatePicker.js"></script>
 <script type="text/javascript" src="../src/com/aurora/ui/theme/default/resource/checkbox/CheckBox.js"></script>
    </head>
    <body >
		
	<script>
		
		//表单上的业务逻辑规则
		function updateFormData(record) {
			var type_id = record.get('CONTRACT_TYPE_ID');
			if(type_id == 1){
				record.getMeta().getField('CONTRACT_NUMBER').setRequired(true);
			}else{
				record.getMeta().getField('CONTRACT_NUMBER').setRequired(false);
			}
		}
		
		
				
		//合同对象
		var contractfields = [
			{name:'LINE_ID',readonly:true},
			{name:'PARTNER_CATEGORY',required:true},
			{name:'PARTNER_ID',required:true},
			{name:'BANK_BRANCH_CODE',required:true},
			{name:'BANK_ACCOUNT_CODE',required:true}
			]
		var contract = new Aurora.DataSet({
			id:'contract',
			fields:contractfields
		});


		//资金计划
		var paymentFields = [
			{name:'LINE_ID',readonly:true},
			{name:'AMOUNT',required:true},
			{name:'CURRENCY_CODE',required:true}
		]
		var payment = new Aurora.DataSet({
			id:'payment',
			fields: paymentFields
		});

		
		//合同
		var hfields = [
			{name:'HEAD_ID',type:'int',readonly:true},
			{name:'CONTRACT_TYPE_ID',type:'int',required:true},
			{name:'CONTRACT_NUMBER',type:'int'},
			{name:'DOCUMENT_NUMBER',type:'int',required:true},
			{name:'DOCUMENT_DESC',type:'string',required:true}]
		var head = new Aurora.DataSet({
			id:'head',
			fields:hfields,
			submitUrl:'http://localhost:8080/demo/contract_create_control.service'
		});

		//合同头绑定合同对象和资金计划
		head.bind('CONTRACT', contract);
		head.bind('PAYMENT', payment);

		//事件处理函数
		function onFormChange(ds, record){
			updateFormData(record)
		}
		
		//绑定合同的DataSet事件
		head.on('update', onFormChange);
		head.on('indexChange', onFormChange)
	</script>
	
<br/><br/>
	<TABLE cellSpacing="0" cellPadding="0">
	<TBODY>
	<TR height="25">
		<TH scope="row" width="75">
			<SPAN class="item-label" style="float:right">主键:</SPAN>
		</TH>
		<TD width="170">

			<DIV class="item-wrap" id="HEAD_ID">
				<INPUT class="item-textField" atype="field.input" style="width: 167px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'HEAD_ID'
				});	
				$('HEAD_ID').bind(head,'HEAD_ID');
			</script>
		</TD>
		<TH scope="row" width="75">
			<SPAN class="item-label" style="float:right">合同类型:</SPAN>
		</TH>
		<TD width="170">

			<DIV class="item-wrap" id="CONTRACT_TYPE_ID">
				<INPUT class="item-textField" atype="field.input" style="width: 167px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'CONTRACT_TYPE_ID'
				});	
				$('CONTRACT_TYPE_ID').bind(head,'CONTRACT_TYPE_ID');
			</script>
		</TD>
		<TH scope="row" width="75">
			<SPAN class="item-label" style="float:right">合同编号:</SPAN>
		</TH>
		<TD width="170">

			<DIV class="item-wrap" id="CONTRACT_NUMBER">
				<INPUT class="item-textField" atype="field.input" style="width: 167px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'CONTRACT_NUMBER'
				});	
				$('CONTRACT_NUMBER').bind(head,'CONTRACT_NUMBER');
			</script>
		</TD>
	</TR>
	<TR height="25">
		<TH scope="row" width="75">
			<SPAN class="item-label" style="float:right">合同号:</SPAN>
		</TH>
		<TD width="170">

			<DIV class="item-wrap" id="DOCUMENT_NUMBER">
				<INPUT class="item-textField" atype="field.input" style="width: 167px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'DOCUMENT_NUMBER'
				});	
				$('DOCUMENT_NUMBER').bind(head,'DOCUMENT_NUMBER');
			</script>
		</TD>
	
		<TH scope="row" width="75">
			<SPAN class="item-label" style="float:right">合同名称:</SPAN>
		</TH>
		<TD width="170">

			<DIV class="item-wrap" id="DOCUMENT_DESC">
				<INPUT class="item-textField" atype="field.input" style="width: 167px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'DOCUMENT_DESC'
				});	
				$('DOCUMENT_DESC').bind(head,'DOCUMENT_DESC');
			</script>
		</TD>
		<TH scope="row" width="75">
			<SPAN class="item-label" style="float:right">版本说明:</SPAN>
		</TH>
		<TD width="170" cols="5">
			<DIV class="item-wrap" id="VERSION_DESC">
				<INPUT class="item-textField" atype="field.input" style="width: 167px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'VERSION_DESC'
				});	
				$('VERSION_DESC').bind(head,'VERSION_DESC');
			</script>
		</TD>
		
	</TR>
	</TBODY>
	</TABLE>
	<br/>
	<TABLE cellSpacing="0" cellPadding="0">
	<TBODY>
	<TR height="25">
		<TH scope="row" width="75">
			
		</TH>
		<TD>
			<input type="button" value="新增" onclick="head.create()">
			<input type="button" value="删除" onclick="head.remove()">
			<input type="button" value="保存" onclick="head.submit()">
			<input type="button" value="上一条" onclick="head.pre()">
			<input type="button" value="下一条" onclick="head.next()">
		</TD>
	</TR>
	</TBODY>
	</TABLE>

	<br/><br/><br/><br/>

	
	<TABLE cellSpacing="3" cellPadding="0" style="margin-left:35px;border:1px solid #cccccc">
	<THEAD>
		<TR><TH colspan="10">合同对象</TH></TR>
	</THEAD>
	<TBODY>
	<TR height="25">
		<TD width="120">
			<SPAN class="item-label">主键</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">对象类型</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">对象代码</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">开户行:</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">帐户:</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">备注:</SPAN>
		</TD>
	</TR>
	<TR height="25">
		<TD width="120">

			<DIV class="item-wrap" id="CONTACT_ID">
				<INPUT class="item-textField" atype="field.input" style="width: 117px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'CONTACT_ID'
				});	
				$('CONTACT_ID').bind(contract,'LINE_ID');
			</script>
		</TD>
		<TD width="150">

			<DIV class="item-wrap" id="PARTNER_CATEGORY">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'PARTNER_CATEGORY'
				});	
				$('PARTNER_CATEGORY').bind(contract,'PARTNER_CATEGORY');
			</script>
		</TD>
		<TD width="150">

			<DIV class="item-wrap" id="PARTNER_ID">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'PARTNER_ID'
				});	
				$('PARTNER_ID').bind(contract,'PARTNER_ID');
			</script>
		</TD>
		<TD width="150">

			<DIV class="item-wrap" id="BANK_BRANCH_CODE">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'BANK_BRANCH_CODE'
				});	
				$('BANK_BRANCH_CODE').bind(contract,'BANK_BRANCH_CODE');
			</script>
		</TD>
		<TD width="150">

			<DIV class="item-wrap" id="BANK_ACCOUNT_CODE">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'BANK_ACCOUNT_CODE'
				});	
				$('BANK_ACCOUNT_CODE').bind(contract,'BANK_ACCOUNT_CODE');
			</script>
		</TD>
		<TD width="150" cols="5">
			<DIV class="item-wrap" id="MEMO">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'MEMO'
				});	
				$('MEMO').bind(contract,'MEMO');
			</script>
		</TD>
	</TR>
	<TR height="45">
		<TD colspan="7">
			<input type="button" value="新增" onclick="contract.create()">
			<input type="button" value="删除" onclick="contract.remove()">
			<input type="button" value="上一条" onclick="contract.pre()">
			<input type="button" value="下一条" onclick="contract.next()">
		</TD>
	</TR>
	</TBODY>
	</TABLE>
	

	<br/><br/>
	<TABLE cellSpacing="3" cellPadding="0" style="margin-left:35px;border:1px solid #cccccc">
	<THEAD>
		<TR><TH colspan="10">资金计划</TH></TR>
	</THEAD>
	<TBODY>
	<TR height="25">
		<TD width="120">
			<SPAN class="item-label">主键</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">金额</SPAN>
		</TD>
		<TD width="150">
			<SPAN class="item-label">币种</SPAN>
		</TD>
	</TR>
	<TR height="25">
		<TD width="120">

			<DIV class="item-wrap" id="PAYMENT_ID">
				<INPUT class="item-textField" atype="field.input" style="width: 117px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'PAYMENT_ID'
				});	
				$('PAYMENT_ID').bind(payment,'LINE_ID');
			</script>
		</TD>
		<TD width="150">

			<DIV class="item-wrap" id="AMOUNT">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'AMOUNT'
				});	
				$('AMOUNT').bind(payment,'AMOUNT');
			</script>
		</TD>
		<TD width="150">

			<DIV class="item-wrap" id="CURRENCY_CODE">
				<INPUT class="item-textField" atype="field.input" style="width: 147px;" name="city" autocomplete="off" value="" />
			</DIV>
			<script>
				new Aurora.TextField({
					id:'CURRENCY_CODE'
				});	
				$('CURRENCY_CODE').bind(payment,'CURRENCY_CODE');
			</script>
		</TD>
	</TR>
	<TR height="45">
		<TD colspan="7">
			<input type="button" value="新增" onclick="payment.create()">
			<input type="button" value="删除" onclick="payment.remove()">
			<input type="button" value="上一条" onclick="payment.pre()">
			<input type="button" value="下一条" onclick="payment.next()">
		</TD>
	</TR>
	</TBODY>
	</TABLE>

	


	<DIV ID="console" style="width:500px;height:300px;"></DIV>
</body>
</html>
