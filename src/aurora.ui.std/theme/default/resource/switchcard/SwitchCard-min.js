(function(b){var f=".switchcard-body",d="",h="none",a="url",e="display",c="cardhide",g="cardshow";b.SwitchCard=Ext.extend(b.Component,{initComponent:function(i){var j=this;b.SwitchCard.superclass.initComponent.call(j,i);j.wrap.select(f+"[url]{display!=none}").each(j.load,j)},processDatasetListener:function(j){var k=this,i=k.binder;if(i){var l=i.ds;l[j]("update",k.onUpdate,k);l[j]("indexchange",k.onIndexChange,k)}},initEvents:function(){b.SwitchCard.superclass.addEvents.call(this);this.addEvents(c,g);this.processListener("on")},onUpdate:function(l,i,k,j){if(this.binder&&this.binder.name==k){this.showByValue(j)}},onIndexChange:function(k,i,j){if(this.binder&&(j=this.binder.name)){this.showByValue(i.get(j))}},showByIndexs:function(){var i=this,j=Ext.isArray(arguments[0])?arguments[0]:Ext.toArray(arguments);i.wrap.select(f).each(function(k,n,m){var o=j.indexOf(m)==-1;if(o){if(!k.isStyle(e,h)){k.setStyle({display:h});var l=Ext.get(k.dom);i.fireEvent(c,i,l.cmps,l)}}else{i.load(k)}})},load:function(i){i=Ext.get(i.dom);var k=this,j=i.getAttributeNS(d,a);if(Ext.isEmpty(j)){if(i.isStyle(e,h)){i.setStyle({display:d});k.fireEvent(g,k,i.cmps,i)}}else{i.setStyle({display:d});i.cmps={};k.showLoading(i);Ext.Ajax.request({url:Ext.urlAppend(i.getAttributeNS(d,a),"_vw="+b.getViewportWidth()+"&_vh="+b.getViewportHeight()),success:function(l,m){k.clearLoading(i);i.set({url:d});i.update(l.responseText,true,function(){k.fireEvent(g,k,i.cmps,i)},i)},failure:function(l){i.update(l.responseText)}})}},showByValue:function(k){var j=this,i=j.wrap;i.select(f+"[case!="+k+"]").each(function(l){if(!l.isStyle(e,h)){l.setStyle({display:h});var m=Ext.get(l.dom);j.fireEvent(c,j,m.cmps,m)}},j);i.select(f+"[case="+k+"]").each(j.load,j)},bind:function(l,i){if(Ext.isString(l)){l=$(l);if(!l){return}}var k=this,j=l.getCurrentRecord();k.binder={ds:l,name:i};k.processDatasetListener("on");k.showByValue(j?j.get(i):null)},showLoading:function(i){i.update(_lang["switchcard.loading"]).setStyle({"text-align":"center","line-height":5})},clearLoading:function(i){i.update(d).setStyle({"text-align":d,"line-height":d})},destroy:function(){var j=this,i=j.wrap;Ext.each(i.query(f),function(k){Ext.iterate(Ext.get(k).cmps,function(l,m){try{m.destroy&&m.destroy()}catch(n){alert("销毁SwitchCard出错: "+n)}})});b.SwitchCard.superclass.destroy.call(j)}});b.SwitchCard.revision="$Rev: 8607 $"})($A);